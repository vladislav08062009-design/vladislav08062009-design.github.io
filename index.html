<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–û–ø—Ä–æ—Å –æ —Å–ø–æ—Ä—Ç–µ</title>

<style>
body{
    font-family: Arial, sans-serif;
    margin:0;
    padding:20px;
    color:#222;

    /* –°–ø–æ—Ä—Ç–∏–≤–Ω—ã–π —Ñ–æ–Ω */
    background: linear-gradient(rgba(255,255,255,0.85), rgba(255,255,255,0.85)),
    url("https://images.unsplash.com/photo-1517649763962-0c623066013b") no-repeat center center fixed;
    background-size: cover;
}

h1{
    text-align:center;
    margin-bottom:20px;
}

.admin-btn{
    display:none;
    margin-bottom:30px;
    padding:10px 15px;
    border:none;
    border-radius:10px;
    background:#ff4444;
    color:white;
    cursor:pointer;
}

.question{
    background:#ffffff;
    padding:20px;
    border-radius:15px;
    margin-bottom:30px;
    box-shadow:0 5px 15px rgba(0,0,0,0.15);
}

button{
    display:block;
    width:100%;
    margin:8px 0;
    padding:12px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:16px;
    background:#4CAF50;
    color:white;
    transition:0.3s;
}

button:hover{
    background:#43a047;
}

button:disabled{
    background:gray;
    cursor:not-allowed;
}

.progress-bar{
    background:#e0e0e0;
    border-radius:20px;
    overflow:hidden;
    height:25px;
    margin:5px 0 15px 0;
}

.progress{
    height:100%;
    background:linear-gradient(90deg,#00c6ff,#00ff99);
    text-align:center;
    line-height:25px;
    color:#000;
    font-weight:bold;
    transition:width 0.5s;
}
</style>
</head>
<body>

<h1>üèÜ –û–ø—Ä–æ—Å –æ —Å–ø–æ—Ä—Ç–µ</h1>
<button id="resetBtn" class="admin-btn">–°–±—Ä–æ—Å–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</button>

<div id="survey"></div>

<script>
const ADMIN_KEY = "123";
const urlParams = new URLSearchParams(window.location.search);
const isAdmin = urlParams.get("admin") === ADMIN_KEY;

if(isAdmin){
    document.getElementById("resetBtn").style.display="block";
}

document.getElementById("resetBtn").onclick = ()=>{
    if(confirm("–¢–æ—á–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –≥–æ–ª–æ—Å–∞?")){
        localStorage.removeItem("votes");
        localStorage.removeItem("voted");
        location.reload();
    }
};

const questions = [
{
    text:"–ö–∞–∫ —á–∞—Å—Ç–æ —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è —Å–ø–æ—Ä—Ç–æ–º?",
    answers:["1-3 —Ä–∞–∑–∞","4-5 —Ä–∞–∑","5 –∏ –±–æ–ª–µ–µ"]
},
{
    text:"–ö–∞–∫–∏–º —Å–ø–æ—Ä—Ç–æ–º —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è?",
    answers:["–í–æ–ª–µ–π–±–æ–ª, –±–∞—Å–∫–µ—Ç–±–æ–ª","–§—É—Ç–±–æ–ª, —Ö–æ–∫–∫–µ–π","–î—Ä—É–≥–æ–µ"]
},
{
    text:"–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ —Ç–µ–±–µ —Ö–æ–¥–∏—Ç—å –Ω–∞ —ç—Ç–æ—Ç –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞?",
    answers:["–î–∞","–°–∫–æ—Ä–µ–µ –¥–∞","–°–∫–æ—Ä–µ–µ –Ω–µ—Ç","–ù–µ—Ç"]
},
{
    text:"–ö–∞–∫ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –ø–æ—Å–ª–µ –∑–∞–Ω—è—Ç–∏–π —Ñ–∏–∑—Ä–æ–π?",
    answers:["–•–æ—Ä–æ—à–æ, –≤–µ—Å–µ–ª–æ","–ù–æ—Ä–º–∞–ª—å–Ω–æ","–ù–µ –æ—á–µ–Ω—å","–ü–ª–æ—Ö–æ"]
},
{
    text:"–ù—Ä–∞–≤—è—Ç—Å—è –ª–∏ —Ç–µ–±–µ –∑–∞–Ω—è—Ç–∏—è —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä—ã?",
    answers:["–î–∞","–ù–µ—Ç"]
},
{
    text:"–ö–∞–∫–∏–µ —ç–º–æ—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —É —Ç–µ–±—è —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä–∞ –∏ —Å–ø–æ—Ä—Ç?",
    answers:["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ","–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ","–ù–∏–∫–∞–∫–∏–µ"]
}
];

let votes = JSON.parse(localStorage.getItem("votes")) || questions.map(q => new Array(q.answers.length).fill(0));
let voted = JSON.parse(localStorage.getItem("voted")) || {};

const surveyDiv = document.getElementById("survey");

questions.forEach((q,index)=>{
    const div = document.createElement("div");
    div.className="question";

    const title = document.createElement("h3");
    title.textContent = q.text;
    div.appendChild(title);

    q.answers.forEach((ans,i)=>{
        const btn = document.createElement("button");
        btn.textContent = ans;

        if(voted[index]) btn.disabled = true;

        btn.onclick = ()=>{
            if(!voted[index]){
                votes[index][i]++;
                voted[index]=true;
                localStorage.setItem("votes",JSON.stringify(votes));
                localStorage.setItem("voted",JSON.stringify(voted));
                render();
            }
        };

        div.appendChild(btn);
    });

    const result = document.createElement("div");
    result.id="result"+index;
    div.appendChild(result);

    surveyDiv.appendChild(div);
});

function render(){
    questions.forEach((q,index)=>{
        const total = votes[index].reduce((a,b)=>a+b,0);
        const resultDiv = document.getElementById("result"+index);
        resultDiv.innerHTML="";

        q.answers.forEach((ans,i)=>{
            const percent = total ? ((votes[index][i]/total)*100).toFixed(1) : 0;

            resultDiv.innerHTML += `
                <div>${ans} ‚Äî ${votes[index][i]} –≥–æ–ª–æ—Å–æ–≤ (${percent}%)</div>
                <div class="progress-bar">
                    <div class="progress" style="width:${percent}%">
                        ${percent}%
                    </div>
                </div>
            `;
        });
    });
}

render();
</script>

</body>
</html>
