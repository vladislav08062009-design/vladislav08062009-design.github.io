<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–û–ø—Ä–æ—Å –æ —Å–ø–æ—Ä—Ç–µ</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg,#8B0000,#ff0000);
    color:white;
    margin:0;
    padding:20px;
}

h1{
    text-align:center;
}

.question{
    background: rgba(255,255,255,0.1);
    padding:20px;
    border-radius:15px;
    margin-bottom:30px;
    box-shadow:0 0 15px rgba(0,0,0,0.4);
}

button{
    display:block;
    width:100%;
    margin:8px 0;
    padding:10px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:16px;
    background:#ff4d4d;
    color:white;
    transition:0.3s;
}

button:hover{
    background:#ff1a1a;
}

button:disabled{
    background:gray;
    cursor:not-allowed;
}

.result{
    margin-top:10px;
}

canvas{
    background:white;
    border-radius:10px;
    margin-top:10px;
}
</style>
</head>
<body>

<h1>üèÜ –û–ø—Ä–æ—Å –æ —Å–ø–æ—Ä—Ç–µ</h1>

<div id="survey"></div>

<script>
const questions = [
{
    text:"–ö–∞–∫ —á–∞—Å—Ç–æ —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è —Å–ø–æ—Ä—Ç–æ–º?",
    answers:["1-3 —Ä–∞–∑–∞","4-5 —Ä–∞–∑","5 –∏ –±–æ–ª–µ–µ"]
},
{
    text:"–ö–∞–∫–∏–º —Å–ø–æ—Ä—Ç–æ–º —Ç—ã –∑–∞–Ω–∏–º–∞–µ—à—å—Å—è?",
    answers:["–í–æ–ª–µ–π–±–æ–ª, –±–∞—Å–∫–µ—Ç–±–æ–ª","–§—É—Ç–±–æ–ª, —Ö–æ–∫–∫–µ–π","–î—Ä—É–≥–æ–µ"]
},
{
    text:"–ù—Ä–∞–≤–∏—Ç—Å—è –ª–∏ —Ç–µ–±–µ —Ö–æ–¥–∏—Ç—å –Ω–∞ —ç—Ç–æ—Ç –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞?",
    answers:["–î–∞","–°–∫–æ—Ä–µ–µ –¥–∞","–°–∫–æ—Ä–µ–µ –Ω–µ—Ç","–ù–µ—Ç"]
},
{
    text:"–ö–∞–∫ —Ç—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –ø–æ—Å–ª–µ –∑–∞–Ω—è—Ç–∏–π —Ñ–∏–∑—Ä–æ–π?",
    answers:["–•–æ—Ä–æ—à–æ, –≤–µ—Å–µ–ª–æ","–ù–æ—Ä–º–∞–ª—å–Ω–æ","–ù–µ –æ—á–µ–Ω—å","–ü–ª–æ—Ö–æ"]
},
{
    text:"–ù—Ä–∞–≤—è—Ç—Å—è –ª–∏ —Ç–µ–±–µ –∑–∞–Ω—è—Ç–∏—è —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä—ã?",
    answers:["–î–∞","–ù–µ—Ç"]
},
{
    text:"–ö–∞–∫–∏–µ —ç–º–æ—Ü–∏–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —É —Ç–µ–±—è —Ñ–∏–∑–∫—É–ª—å—Ç—É—Ä–∞ –∏ —Å–ø–æ—Ä—Ç?",
    answers:["–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ","–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ","–ù–∏–∫–∞–∫–∏–µ"]
}
];

let votes = JSON.parse(localStorage.getItem("votes")) || questions.map(q => new Array(q.answers.length).fill(0));
let voted = JSON.parse(localStorage.getItem("voted")) || {};

const surveyDiv = document.getElementById("survey");

questions.forEach((q,index)=>{
    const div = document.createElement("div");
    div.className="question";

    const title = document.createElement("h3");
    title.textContent = q.text;
    div.appendChild(title);

    q.answers.forEach((ans,i)=>{
        const btn = document.createElement("button");
        btn.textContent = ans;

        if(voted[index]) btn.disabled = true;

        btn.onclick = ()=>{
            if(!voted[index]){
                votes[index][i]++;
                voted[index]=true;
                localStorage.setItem("votes",JSON.stringify(votes));
                localStorage.setItem("voted",JSON.stringify(voted));
                render();
            }
        };

        div.appendChild(btn);
    });

    const result = document.createElement("div");
    result.className="result";
    result.id="result"+index;
    div.appendChild(result);

    const canvas = document.createElement("canvas");
    canvas.id="chart"+index;
    div.appendChild(canvas);

    surveyDiv.appendChild(div);
});

function render(){
    questions.forEach((q,index)=>{
        const total = votes[index].reduce((a,b)=>a+b,0);
        const resultDiv = document.getElementById("result"+index);
        resultDiv.innerHTML="";

        q.answers.forEach((ans,i)=>{
            const percent = total ? ((votes[index][i]/total)*100).toFixed(1) : 0;
            resultDiv.innerHTML += `<div>${ans}: ${votes[index][i]} –≥–æ–ª–æ—Å–æ–≤ (${percent}%)</div>`;
        });

        new Chart(document.getElementById("chart"+index),{
            type:"bar",
            data:{
                labels:q.answers,
                datasets:[{
                    data:votes[index],
                    backgroundColor:"red"
                }]
            },
            options:{
                plugins:{legend:{display:false}},
                scales:{y:{beginAtZero:true}}
            }
        });
    });
}

render();
</script>

</body>
</html>
